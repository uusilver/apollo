<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--<%@page pageEncoding="UTF-8" contentType="text/html; charset=UTF-8" %>-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="X-UA-Compatible" content="IE=emulateIE7"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>快查-315快查物联网搜索引擎！</title>
    <link href="../css/style.css" rel="stylesheet" type="text/css"/>
    <link href="../css/result.css" rel="stylesheet" type="text/css"/>
    <link href="../css/bootstrap-typeahead.css" rel="stylesheet" type="text/css"/>
    <link href="../css/showLoading.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div class="head">
    <div id="hd" class="ue-clear">
        <div class="logo1"><a href="/"><img src="../img/logo1.png" border="0"/></a></div>
        <div class="inputArea">
            <input type="text" class="searchInput" style="color: #999999;" id="keywords" value="请输入品牌、企业名、产品名、条码号等信息"
                   onfocus="if(this.value=='请输入品牌、企业名、产品名、条码号等信息')this.value=''" onblur="if(this.value=='')this.value="请输入品牌、企业名、产品名、条码号等信息" />

            <input type="button" class="searchButton" id="search"/>


        </div>
    </div>
    <div class="nav">
        <!-- <ul class="searchList">
             <li class="searchItem current">快查舆情</li>
             <li class="searchItem">物品识别码</li>
             <li class="searchItem">网站安全查询</li>
             <li class="searchItem">网站备案查询</li>
             <li class="searchItem">二维码在线生成</li>
         </ul>
         <a href="javascript:;" class="tips">关于快查搜索引擎</a>-->
    </div>
</div>

<div id="container">
    <div id="bd" class="ue-clear">
        <div id="main">
            <div class="sideBar">
                <div class="subfield">专业查询</div>
                <ul class="subfieldContext">
                    <li>
                        <span class="name"><a href="#">防伪溯源查询</a></span>
                    </li>

                    <li>
                        <span class="name"><a href="#">二维码安全检测</a></span>
                    </li>

                </ul>

            </div>

            <div class="resultArea">
                <p class="resultTotal">
                    <span class="info">找到约&nbsp;<span class="totalResult">0</span>&nbsp;条结果(用时<span
                            class="time">0.00</span>秒)</span>
                    <!--<span class="orderOpt">-->
                    <!--<a href="javascript:;" class="byTime">按收录时间排序</a>-->
                    <!--<a href="javascript:;" class="byDependence">按相关度排序</a>-->
                    <!--</span>-->
                </p>
                <!-- 品牌词查询结果显示区域开始-->
                <div class="resultItem2" id="advice" style="display: none">

                </div>
                <!-- 品牌词查询结果显示区域结束-->
                <div class="content" id="priceContent" style="display: none">

                    <div class="list">
                        <div class="app-title"><a href="#">相关商品</a></div>

                        <table class="am-table am-table-striped">
                            <thead>
                            <tr class="am-success">
                                <th>单品名称/条码号</th>
                                <th>渠道价格</th>
                                <th>零售价格</th>
                            </tr>
                            </thead>
                            <tbody id="priceList">

                            </tbody>
                        </table>
                        <div class='app-bottom'>
                            <div shopping-bottom><span class="app-bleft"><i class="am-icon-pencil am-icon-fw"></i>315快查框架聚合数据（仅供参考）</span>
                                <span class="app-bright"><a href="result2.html">查看全部结果 ></a></span>
                            </div>
                        </div>
                    </div>

                </div>
                <!-- resultList ID保留，加载数据 -->
                <div class="resultList" id="resultList">

                    <!-- 查询结果显示区域-->

                </div>
                <!-- 分页 -->
                <div class="pagination ue-clear"></div>


            </div>

            <div class="historyArea">
                <div class="historyList"><h6>315快查搜索:</h6><span class="jiangjie">这是一款没有竞价广告推广的客观数据搜索引擎！</span></div>

                <div class="hotSearch">
                    <h6>热门搜索</h6>
                    <ul class="historyList">
                        <li><a href="http://www.315kc.cn/result.html?%E8%80%81%E6%B3%A5%E6%B1%A0">老泥池</a></li>
                        <!--<li><a href="javascript:;">关键词1</a></li>-->
                        <!--<li><a href="javascript:;">关键词1</a></li>-->
                        <!--<li><a href="javascript:;">关键词1</a></li>-->
                        <!--<li><a href="javascript:;">关键词1</a></li>-->
                        <!--<li><a href="javascript:;">关键词1</a></li>-->
                    </ul>
                </div>
                <div class="mySearch">
                    <h6>我的搜索</h6>
                    <ul class="historyList">
                        <li><a href="http://www.315kc.cn/result.html?%E8%80%81%E6%B3%A5%E6%B1%A0">老泥池</a></li>
                        <!--<li><a href="javascript:;">关键词2</a></li>-->
                        <!--<li><a href="javascript:;">关键词2</a></li>-->
                        <!--<li><a href="javascript:;">关键词2</a></li>-->
                    </ul>
                </div>
            </div>
        </div>
        <!-- End of main -->
    </div>
    <!--End of bd-->
</div>

<div class="foot">
    <div class="wrap">
        <div class="wrap2">
            <div class="wrap3">
                <a href="guanyu.html" style="cursor:pointer;">关于我们</a><a href="jieshao.html">搜索引擎介绍</a><a
                    href="mianze.html">免责声明</a><a href="shangwu.html">商务合作</a><a href="kaifang.html">开放平台</a><a
                    href="yijian.html">意见反馈</a>
            </div>
            <div style="clear:both;">Copyright 2010-2017&nbsp;&nbsp;315快查搜索服务&nbsp;&nbsp;国家工业信息化部网站备案号：<a
                    href="http://www.miitbeian.gov.cn/" target="_blank">苏ICP备16010616号</a>
            </div>
        </div>
    </div>
</div>
</body>
<script type="text/javascript" src="../js/jquery.js"></script>
<script type="text/javascript" src="../js/bootstrap-typehead.js"></script>

<script type="text/javascript" src="../js/global.js"></script>
<script type="text/javascript" src="../js/pagination.js"></script>
<script type="text/javascript" src="../js/jquery.showLoading.min.js"></script>
<script type="text/javascript">
    $('.searchList').on('click', '.searchItem', function () {
        $('.searchList .searchItem').removeClass('current');
        $(this).addClass('current');
    });


    $.each($('.subfieldContext'), function (i, item) {
        $(this).find('li:gt(2)').hide().end().find('li:last').show();
    });

    $('.subfieldContext .more').click(function (e) {
        var $more = $(this).parent('.subfieldContext').find('.more');
        if ($more.hasClass('show')) {

            if ($(this).hasClass('define')) {
                $(this).parent('.subfieldContext').find('.more').removeClass('show').find('.text').text('自定义');
            } else {
                $(this).parent('.subfieldContext').find('.more').removeClass('show').find('.text').text('更多');
            }
            $(this).parent('.subfieldContext').find('li:gt(2)').hide().end().find('li:last').show();
        } else {
            $(this).parent('.subfieldContext').find('.more').addClass('show').find('.text').text('收起');
            $(this).parent('.subfieldContext').find('li:gt(2)').show();
        }

    });

    $('.sideBarShowHide a').click(function (e) {
        if ($('#main').hasClass('sideBarHide')) {
            $('#main').removeClass('sideBarHide');
            $('#container').removeClass('sideBarHide');
        } else {
            $('#main').addClass('sideBarHide');
            $('#container').addClass('sideBarHide');
        }

    });


    setHeight();
    $(window).resize(function () {
        setHeight();
    });

    function setHeight() {
        if ($('#container').outerHeight() < $(window).height()) {
            $('#container').height($(window).height() - 33);
        }
    }
</script>

<script>
    $(function () {

        $("body").keydown(function () {
            if (event.keyCode == "13") {//keyCode=13是回车键
                $("#search").trigger('click');
            }
        });
        var keywords = window.location.href.split("?")[1];

        //******************搜索方法区开始***************************************************************
        if (keywords) {
            var searchKeyWords = decodeURI(keywords);

            search(searchKeyWords, 0, 0);
            //加载广告
            $("#advice").css('display','none');
            loadAdvice(searchKeyWords);
            //加载价格信息
            $("#priceContent").css('display', 'none');
            loadPrice(searchKeyWords);
            $("#keywords").val(searchKeyWords);
            $(document).attr("title", searchKeyWords + "-快查-315快查物联网搜索引擎");//修改title值
        }

        $("#search").click(function () {
            var keywords = $("#keywords").val();
            search(keywords, 0, 0);
            //加载广告
            $("#advice").css('display','none');
            loadAdvice(keywords);
            //加载价格信息
            $("#priceContent").css('display', 'none');
            loadPrice(keywords);

            $(document).attr("title", keywords + "-快查-315快查物联网搜索引擎");//修改title值

        })

        //******************搜索方法区结束***************************************************************

        //Auto complete
        $('#keywords').typeahead({
            source: function (query, process) {
                var parameter = {query: query};
                $.post('/autoComplete', parameter, function (data) {
                    process(eval("(" + data + ")"));
                });
            }
        });

    })

    function search(keywords, pageNo, totalCount) {
        $("#resultList").showLoading();
        $.ajax({
            url: '../search',
            type: "post",
            data: {
                keywords: keywords,
                pageNo: pageNo,
                totalResult: totalCount
            },
            success: function (result) {
                loadInfoOnPage(result); //数据放在页面上
                //加载广告信息
                $("#resultList").hideLoading();
            }
        })//end of ajax call

    }

    //加载广告信息
    function loadAdvice(keywords){
        $.ajax({
            url: '../advice',
            type: "post",
            data: {
                keywords: keywords
            },
            success: function (result) {
                if(result.length>0){
                    $("#advice").html(result);
                    $("#advice").css('display','block');
                }
            }
        })
    }

    //加载价格信息
    function loadPrice(keywords){
        $.ajax({
            url: '../smallList',
            type: "post",
            data: {
                keywords: keywords
            },
            success: function (result) {
                var dataObj = eval("(" + result + ")");
                var html = '';
                for (var i = 0; i < dataObj.length; i++) {
                    html+="<tr>";
                    html+="<td>"+dataObj[i].brand+"<br/> <span>"+dataObj[i].barCode+"</span></td>";
                    html+="<td>"+dataObj[i].agencyPrice+"</td>";
                    html+="<td>"+dataObj[i].sellPrice+"</td>";
                    html+="</tr>";
                }
                $("#priceList").html(html);
                if(dataObj.length>0){
                    $("#priceContent").css('display', 'block');
                }
            }
        })
    }

    function loadInfoOnPage(result) {
        var dataObj = eval("(" + result + ")");
        if (dataObj.totalResult > 0) {
            var html = '';
            for (var i = 0; i < dataObj.searchItemSet.length; i++) {
                html += "<div class='resultItem'><div class='itemHead'>";
                html += " <a href='" + dataObj.searchItemSet[i].url + "' target='_blank' class='title'>" + dataObj.searchItemSet[i].title + "</a>";
                html += "</div>";
                html += "<div class='itemBody'>";
                html += dataObj.searchItemSet[i].body_content
                html += "</div>";
                html += "<div class='itemFoot'> <span class='fileType'><span class='label'>搜索引擎：</span><span class='value'>" + dataObj.searchItemSet[i].source + "</span></span>";
                html += "<span class='info'><label>收录时间：</label><span class='value'>" + dataObj.searchItemSet[i].create_date + "</span> </span></div> </div>";
            }
            $("#resultList").html(html);

            //TODO 动态加载分页信息
            $(".pagination").pagination(dataObj.totalResult, {
                current_page: 0, //当前页码
                items_per_page: 10,
                display_msg: true,
                callback: pageselectCallback
            });
            function pageselectCallback(page_id, jq) {
                //                    alert("当前页id(由0开始)：" + page_id + "，\n每页显示：" + this.items_per_page + "条数据");
                var keywords = $("#keywords").val();
                search(keywords, page_id, dataObj.totalResult);

            }

            //查询信息加载
            $(".totalResult").text(dataObj.totalResult);
            $(".time").text(dataObj.executeTime / 1000);
        }

    }
</script>
</html>